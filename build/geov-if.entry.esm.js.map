{"version":3,"file":"geov-if.entry.esm.js","sources":["node_modules/@geovistory/design-system-web/dist/collection/components/geov-if/geov-if.css?tag=geov-if","node_modules/@geovistory/design-system-web/dist/collection/components/geov-if/geov-if.js"],"sourcesContent":[":host {\n  display: block;\n}\n","import { h, Host } from \"@stencil/core\";\nimport { sparqlJson } from \"../../lib/sparqlJson\";\nimport { getSSRData } from \"../../lib/ssr/getSSRData\";\nimport { setSSRData } from \"../../lib/ssr/setSSRData\";\nimport { setSSRId } from \"../../lib/ssr/setSSRId\";\n/**\n * Small helper component to wrap a piece of html\n * into a container that does a sparql request and displays\n * its children, if the request returns `true` on the\n * `?condition` binding of the first returned record.\n */\nexport class GeovIf {\n  constructor() {\n    this._ssrId = undefined;\n    this.sparqlEndpoint = undefined;\n    this.sparqlQuery = undefined;\n    this.data = { loading: true, showChildren: false };\n    setSSRId(this);\n  }\n  async componentWillLoad() {\n    // try to get data from ssr\n    this.data = getSSRData(this._ssrId);\n    // if no data found, fetchData\n    if (!this.data) {\n      // set data to loading (in immutable way)\n      this.data = { loading: true, showChildren: false };\n      await this.fetchData()\n        .then(d => {\n        this.data = d;\n        setSSRData(this._ssrId, d);\n        return d;\n      })\n        .catch(d => {\n        this.data = d;\n        return d;\n      });\n    }\n  }\n  /**\n   * Do the sparql request(s)\n   * @returns a Promise with the data for this component\n   */\n  async fetchData() {\n    const q = this.sparqlQuery\n      .replace(/&amp;/g, '&')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&quot;/g, '\"')\n      .replace(/&apos;/g, \"'\");\n    return sparqlJson(this.sparqlEndpoint, q)\n      .then(res => {\n      var _a, _b, _c, _d;\n      const showChildren = ((_d = (_c = (_b = (_a = res === null || res === void 0 ? void 0 : res.results) === null || _a === void 0 ? void 0 : _a.bindings) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.condition) === null || _d === void 0 ? void 0 : _d.value) === 'true' ? true : false;\n      return Object.assign(Object.assign({}, this.data), { showChildren, loading: false });\n    })\n      .catch(_ => {\n      return Object.assign(Object.assign({}, this.data), { error: true, loading: false });\n    });\n  }\n  render() {\n    const display = this.data.showChildren ? 'initital' : 'none';\n    return (h(Host, null, h(\"div\", { style: { display: display } }, h(\"slot\", null))));\n  }\n  static get is() { return \"geov-if\"; }\n  static get originalStyleUrls() {\n    return {\n      \"$\": [\"geov-if.css\"]\n    };\n  }\n  static get styleUrls() {\n    return {\n      \"$\": [\"geov-if.css\"]\n    };\n  }\n  static get properties() {\n    return {\n      \"_ssrId\": {\n        \"type\": \"string\",\n        \"mutable\": false,\n        \"complexType\": {\n          \"original\": \"string\",\n          \"resolved\": \"string\",\n          \"references\": {}\n        },\n        \"required\": false,\n        \"optional\": true,\n        \"docs\": {\n          \"tags\": [],\n          \"text\": \"\"\n        },\n        \"attribute\": \"_ssr-id\",\n        \"reflect\": true\n      },\n      \"sparqlEndpoint\": {\n        \"type\": \"string\",\n        \"mutable\": false,\n        \"complexType\": {\n          \"original\": \"string\",\n          \"resolved\": \"string\",\n          \"references\": {}\n        },\n        \"required\": false,\n        \"optional\": false,\n        \"docs\": {\n          \"tags\": [],\n          \"text\": \"sparqlEndpoint\\nURL of the sparql endpoint\"\n        },\n        \"attribute\": \"sparql-endpoint\",\n        \"reflect\": false\n      },\n      \"sparqlQuery\": {\n        \"type\": \"string\",\n        \"mutable\": false,\n        \"complexType\": {\n          \"original\": \"string\",\n          \"resolved\": \"string\",\n          \"references\": {}\n        },\n        \"required\": false,\n        \"optional\": false,\n        \"docs\": {\n          \"tags\": [],\n          \"text\": \"A sparql query with binding ?condition of type ^^xsd:bolean.\\nIf the first ?condition of response is true,\\nthe children of the element are rendered, otherwise not.\\n\\nExample:\\n```sparql\\n# check if geov:i836507 is annotated entity (ontome:p1875)\\n# of an annotation in text (ontome:p1875)\\nPREFIX ontome: <https://ontome.net/ontology/>\\nPREFIX geov: <http://geovistory.org/resource/>\\n\\nSELECT  ((count(?subject ) > 0)as ?condition)\\nWHERE {\\n  ?subject ontome:p1875 geov:i836507 .\\n  ?subject a ontome:c933\\n}\\nGROUP BY ?subject\\nLIMIT 1\\n```\"\n        },\n        \"attribute\": \"sparql-query\",\n        \"reflect\": false\n      }\n    };\n  }\n  static get states() {\n    return {\n      \"data\": {}\n    };\n  }\n}\n//# sourceMappingURL=geov-if.js.map\n"],"names":[],"mappings":"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","x_google_ignoreList":[0,1]}